parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"zf4f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=function(){return function(e){this.colour=e}}(),t=e;exports.default=t;
},{}],"iOdR":[function(require,module,exports) {

},{}],"LsF4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=require("./hsl_color"),t=1/6,n=1/3,e=2/3,a=function(){function a(){}return a.randomInt=function(r,t){return Math.floor(Math.random()*(t-r+1)+r)},a.rgb2hex=function(r){var t="000000"+r.toString(16);return"#"+t.substr(t.length-6)},a.int2hex=function(r){var t="00"+r.toString(16);return t.substr(t.length-2)},a.average=function(r){for(var t=0,n=0,e=0,a=r;e<a.length;e++){var u=a[e];null!==u&&(n++,t+=u.vitality)}return t/n},a.maxVitality=function(r){for(var t=0,n=0,e=r;n<e.length;n++){var a=e[n];null!==a&&a.vitality>t&&(t=a.vitality)}return t},a.maxSaturation=function(r){for(var t,n=0;n<r.length;n+=4){t=Math.max(r[n],r[n+1],r[n+2]);for(var e=0;e<3;e++)r[n+e]===t?r[n+e]=255:r[n+e]=0}return r},a.hue2rgb=function(r,n,a){return a<0&&(a+=1),a>1&&(a-=1),a<t?r+6*(n-r)*a:a<.5?n:a<e?r+(n-r)*(e-a)*6:r},a.hsl2rgb=function(r){var t=r[0],e=r[1],a=r[2];if(0===e)return[a,a,a];var u=a<.5?a*e+a:a+e-a*e,i=2*a-u;return[this.hue2rgb(i,u,t+n),this.hue2rgb(i,u,t),this.hue2rgb(i,u,t-n)]},a.rgb2hsl=function(t,n,e){t/=255,n/=255,e/=255;var a=Math.max(t,n,e),u=Math.min(t,n,e),i=(a+u)/2,o=(a+u)/2,l=(a+u)/2;if(a===u)i=o=0;else{var h=a-u;switch(o=l>.5?h/(2-a-u):h/(a+u),a){case t:i=(n-e)/h+(n<e?6:0);break;case n:i=(e-t)/h+2;break;case e:i=(t-n)/h+4}i/=6}return new r.HSLColor(i,o,l)},a}(),u=a;exports.default=u;
},{"./hsl_color":"iOdR"}],"aaNL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./tile")),i=e(require("./util"));function e(t){return t&&t.__esModule?t:{default:t}}var s=function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),o=function(t){function e(e,s,o,h,r,a,n,u,d){void 0===r&&(r=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===u&&(u=i.default.randomInt(20,70)),void 0===d&&(d=-1);var l=t.call(this,n)||this;return l.game=e,l.map=s,l.x=o,l.y=h,l.age=r,l.reproductionValue=a,l.colour=n,l.vitality=u,l.index=d,l.dead=!1,l.diseased=!1,l.game.colonyPush(l),l}return s(e,t),e.prototype.shouldDie=function(){return this.vitality<this.age},e.prototype.cripple=function(t){if(!(Math.random()<.5)){if(t&&this.diseased)return this.vitality*=2,void(this.diseased=!1);this.vitality/=2,this.diseased=!0}},e.prototype.move=function(){var t,e;this.age++,this.reproductionValue++;do{t=i.default.randomInt(-1,1),e=i.default.randomInt(-1,1)}while(!this.map.isInBounds(this.x+t,this.y+e)&&0===t&&0===e);var s=this.map.getObj(this.x+t,this.y+e);switch(s?s.colour:this.game.WATER_COLOUR){case this.game.GRASS_COLOUR:this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.reproduce(),this.x+=t,this.y+=e,this.map.setObj(this.x,this.y,this);break;case this.game.WATER_COLOUR:case this.colour:break;default:this.vitality>=this.map.getObj(this.x+t,this.y+e).vitality?(this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.reproduce(),this.x+=t,this.y+=e,this.map.killPerson(this.x,this.y,this)):(this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.kill())}this.shouldDie()&&(this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.kill())},e.prototype.reproduce=function(){if(!(this.reproductionValue<this.game.reproductiveThreshold)){this.reproductionValue=0;var t=i.default.randomInt(-5,5);this.map.setObj(this.x,this.y,new e(this.game,this.map,this.x,this.y,0,i.default.randomInt(0,100),this.colour,this.vitality+t))}},e.prototype.kill=function(){this.dead=!0,this.game.colonyRemove(this)},e}(t.default),h=o;exports.default=h;
},{"./tile":"zf4f","./util":"LsF4"}],"rEAj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=function(){return function(t,e,r){this.r=t,this.g=e,this.b=r}}(),e=t;exports.default=e;
},{}],"IoNL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./person")),i=e(require("./util")),a=e(require("./rgb_color"));function e(t){return t&&t.__esModule?t:{default:t}}var h=function(){function e(t,a,e){this.coloniesNumber=e,this.game=t,this.canvas=a,this.height=a.height,this.width=a.width,this.context=a.getContext("2d"),this.imageData=this.context.getImageData(0,0,this.width,this.height),this.map=[];for(var h=0;h<this.width;h++)this.map[h]=[];for(h=0;h<this.imageData.data.length;h+=4){var o=this.imageData.data[h],s=this.imageData.data[h+1],r=this.imageData.data[h+2],n=i.default.rgb2hsl(o,s,r);if(n===this.game.getColour(this.game.GRASS_COLOUR)){var u=h/4%this.width,d=Math.floor(h/4/this.width);this.map[u][d]=this.game.GRASS_TILE}if(n===this.game.getColour(this.game.WATER_COLOUR)){u=h/4%this.width,d=Math.floor(h/4/this.width);this.map[u][d]=this.game.WATER_TILE}}this.createColonies()}return e.prototype.isInBounds=function(t,i){return t>=0&&t<this.width&&i>=0&&i<this.height},e.prototype.getObj=function(t,i){return this.isInBounds(t,i)?this.map[t][i]:null},e.prototype.setObj=function(t,i,a){this.map[t][i]=a;var e=this.getRGBColour(a.colour),h=4*(i*this.width+t);this.imageData.data[h+0]=e.r,this.imageData.data[h+1]=e.g,this.imageData.data[h+2]=e.b,this.imageData.data[h+3]=255},e.prototype.getRGBColour=function(t){var e=this.game.getColour(t),h=i.default.hsl2rgb(e),o=h[0],s=h[1],r=h[2];return new a.default(o,s,r)},e.prototype.redraw=function(){this.context.putImageData(this.imageData,0,0)},e.prototype.killPerson=function(t,i,a){this.map[t][i].kill(),this.setObj(t,i,a)},e.prototype.createColonies=function(){for(var a,e,h,o,s,r=0;r<this.coloniesNumber;r++){for(;a=i.default.randomInt(0,this.width-1),e=i.default.randomInt(0,this.height-1),this.map[a][e].colour!==this.game.GRASS_COLOUR;);for(var n=0;n<50;n++)for(s=0;;){s+=1;do{s+=.01,h=a+i.default.randomInt(0,10),o=e+i.default.randomInt(0,10)}while(!this.isInBounds(h,o));if(s>=50)break;if(this.map[h][o].colour===this.game.GRASS_COLOUR){this.setObj(h,o,new t.default(this.game,this,h,o,0,i.default.randomInt(0,100),r,i.default.randomInt(0,100)));break}}}},e}(),o=h;exports.default=o;
},{"./person":"aaNL","./util":"LsF4","./rgb_color":"rEAj"}],"xKml":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=i(require("./board")),e=i(require("./tile")),o=i(require("./util"));function i(t){return t&&t.__esModule?t:{default:t}}var s=function(){function i(t,o,i,s,n,l,h,a,r){var c=this;void 0===h&&(h=!1),void 0===a&&(a=""),void 0===r&&(r=""),this.ageCount=0,this.colours=[[60,100,50],[300,100,50],[0,100,50],[272,100,50],[32,100,50],[0,0,53],[240,100,77],[328,100,50],[0,0,0],[208,100,50],[120,100,50],[240,100,50]],this.coloniesColours=this.colours.length-2,this.colonies=[],this.GRASS_COLOUR=this.colours.length-2,this.WATER_COLOUR=this.colours.length-1,this.image=new Image,this.peopleCount=0,this.timer=0,this.paused=!1,this.htmlConnector=t,this.canvas=o,this.speed=n,this.coloniesNumber=s,this.GRASS_TILE=new e.default(this.GRASS_COLOUR),this.WATER_TILE=new e.default(this.WATER_COLOUR),this.reproductiveThreshold=l,this.image.onload=function(){c.setup()},this.image.onerror=function(){window.alert("loading failed")},this.image.src=i}return i.prototype.setup=function(){this.canvas.width=this.image.width,this.canvas.height=this.image.height,this.canvas.getContext("2d").drawImage(this.image,0,0);for(var e=0;e<this.coloniesNumber;e++)this.colonies[e]=[];this.map=new t.default(this,this.canvas,this.coloniesNumber),this.intervalPointer=setInterval(this.play.bind(this),this.speed);var o="";for(e=0;e<this.coloniesNumber;e++)o+='<tr class="colony-table__row colony-table__accent" data-team-color="'+this.colours[e]+'"></tr>';this.htmlConnector.$statisticsPanel.innerHTML='<table class="colony-table">\n    <thead>\n      <tr>\n        <td></td>\n        <td>Colony</td>\n        <td>Population</td>\n        <td>Avg Vit</td>\n        <td>Max Vit</td>\n      </tr>\n    </thead>\n    '+o+"\n    </table>",this.coloniesLabels=this.htmlConnector.$statisticsPanel.querySelectorAll(".colony-table__row")},i.prototype.play=function(){this.lastTime=Date.now();for(var t=0;t<this.coloniesNumber;t++)if(null!==this.colonies[t]){for(var e=0,i=this.colonies[t];e<i.length;e++){var s=i[e];null!==s&&s.move()}0!==this.colonies[t].length?this.coloniesLabels[t].innerHTML='\n      <td class="colony-table__team" style="background-color:'+this.coloniesLabels[t].getAttribute("data-team-color")+'"></td>\n      <td>'+(t+1)+"</td>\n      <td>"+this.colonies[t].length+"</td>\n      <td>"+o.default.average(this.colonies[t]).toFixed(2)+"</td>\n      <td>"+o.default.maxVitality(this.colonies[t]).toFixed(2)+"</td>":(this.coloniesLabels[t].classList.add("colony-table__row--dead"),this.colonies[t]=null)}for(t=0;t<this.coloniesNumber;t++)null!==this.colonies[t]&&(this.colonies[t]=this.colonies[t].filter(function(t){return null!==t}),this.colonies[t].forEach(function(t,e){t.index=e}));this.map.redraw(),this.htmlConnector.$ageLabel.innerHTML="Age: "+this.ageCount++,this.timer+=Date.now()-this.lastTime,this.timer>250&&(this.htmlConnector.$fpsLabel.innerHTML="FPS: "+(1e3/(Date.now()-this.lastTime)).toFixed(0),this.timer=0)},i.prototype.getColour=function(t){return this.colours[t]},i.prototype.colonyPush=function(t){t.index=this.colonies[t.colour].length,this.colonies[t.colour].push(t),this.peopleCount++},i.prototype.colonyRemove=function(t){this.colonies[t.colour][t.index]=null,this.peopleCount--},i.prototype.stop=function(){clearInterval(this.intervalPointer)},i.prototype.pause=function(){this.paused=!0,this.stop()},i.prototype.unpause=function(){this.paused=!1,this.intervalPointer=setInterval(this.play.bind(this),this.speed)},i}(),n=s;exports.default=n;
},{"./board":"IoNL","./tile":"zf4f","./util":"LsF4"}],"Xxxt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./game")),t=o(require("./util"));function o(e){return e&&e.__esModule?e:{default:e}}var n=function(){function o(){var e=this;this.landWaterColours=!1,this.$canvas=document.getElementById("canvas"),this.$statisticsPanel=document.getElementById("test"),this.$ageLabel=document.querySelector("#age"),this.$fpsLabel=document.querySelector("#fps"),this.$mapSelect=document.querySelector("#level_map"),this.$mapSelect.addEventListener("change",function(){e.getPreview()}),this.$numberOfColonies=document.querySelector("#number_of_colonies"),this.$timeInterval=document.querySelector("#time_interval"),this.$reproductiveThreshold=document.querySelector("#reproductive_threshold"),this.$addMap=document.querySelector("#add_map"),this.$addMap.addEventListener("change",function(){e.updateMapList()}),this.$startGame=document.querySelector("#start_game"),this.$startGame.addEventListener("click",function(){e.startGame(),e.$pauseButton.innerHTML="Pause"}),this.$allowGWChanging=document.querySelector("#allow_gw_colours"),this.$allowGWChanging.addEventListener("click",function(){e.allowGWColourChanging()}),this.$pauseButton=document.querySelector("#pause"),this.$pauseButton.addEventListener("click",function(){e.togglePause()}),this.getPreview()}return o.prototype.startGame=function(){this.game&&this.game.stop(),this.game=new e.default(this,this.$canvas,this.$mapSelect.options[this.$mapSelect.selectedIndex].value,parseInt(this.$numberOfColonies.value,10),parseInt(this.$timeInterval.value,10),parseInt(this.$reproductiveThreshold.value,10))},o.prototype.getPreview=function(){var e=document.querySelector("canvas.preview"),t=new Image;t.onload=function(){e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0)},t.onerror=function(){window.alert("loading preview failed")},t.src=this.$mapSelect.options[this.$mapSelect.selectedIndex].value},o.prototype.updateMapList=function(){this.$mapSelect.innerHTML+='<option value="'+window.URL.createObjectURL(this.$addMap.files[0])+'" >'+this.$addMap.files[0].name+"</option>"},o.prototype.allowGWColourChanging=function(){var e=document.querySelector("canvas.preview");this.landWaterColours?(this.landWaterColours=!1,document.querySelector(".colorGWPick").style.display="none",e.removeEventListener("mousemove",this.pick)):(this.landWaterColours=!0,document.querySelector(".colorGWPick").style.display="block",e.addEventListener("mousemove",this.pick))},o.prototype.pick=function(e){var o=e.clientX,n=e.clientY,a=e.target.getContext("2d").getImageData(o,n,1,1).data,i="#"+t.default.int2hex(a[0])+t.default.int2hex(a[1])+t.default.int2hex(a[2]);document.querySelector(".colorGWPick").style.background=i,document.querySelector(".colorGWPick").textContent=i},o.prototype.togglePause=function(){this.game.paused?(this.game.unpause(),this.$pauseButton.innerHTML="Pause"):(this.game.pause(),this.$pauseButton.innerHTML="Resume")},o}(),a=n;exports.default=a;
},{"./game":"xKml","./util":"LsF4"}],"swTO":[function(require,module,exports) {
"use strict";var e=t(require("./html_connector"));function t(e){return e&&e.__esModule?e:{default:e}}window.onload=function(){(new e.default).startGame()};
},{"./html_connector":"Xxxt"}]},{},["swTO"], null)
//# sourceMappingURL=app.f957a5ab.js.map