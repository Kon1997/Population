parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"zf4f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=function(){return function(e){this.colour=e}}(),t=e;exports.default=t;
},{}],"LsF4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=function(){function t(){}return t.randomInt=function(t,r){return Math.floor(Math.random()*(r-t+1)+t)},t.rgb2hex=function(t){var r="000000"+t.toString(16);return"#"+r.substr(r.length-6)},t.int2hex=function(t){var r="00"+t.toString(16);return r.substr(r.length-2)},t.average=function(t){for(var r=0,n=0,e=0,a=t;e<a.length;e++){var o=a[e];null!==o&&(n++,r+=o.vitality)}return r/n},t.maxVitality=function(t){for(var r=0,n=0,e=t;n<e.length;n++){var a=e[n];null!==a&&a.vitality>r&&(r=a.vitality)}return r},t.maxSaturation=function(t){for(var r,n=0;n<t.length;n+=4){r=Math.max(t[n],t[n+1],t[n+2]);for(var e=0;e<3;e++)t[n+e]===r?t[n+e]=255:t[n+e]=0}return t},t}(),r=t;exports.default=r;
},{}],"aaNL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./tile")),i=e(require("./util"));function e(t){return t&&t.__esModule?t:{default:t}}var s=function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),o=function(t){function e(e,s,o,h,r,a,n,u,d){void 0===r&&(r=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===u&&(u=i.default.randomInt(20,70)),void 0===d&&(d=-1);var l=t.call(this,n)||this;return l.game=e,l.map=s,l.x=o,l.y=h,l.age=r,l.reproductionValue=a,l.colour=n,l.vitality=u,l.index=d,l.dead=!1,l.diseased=!1,l.game.colonyPush(l),l}return s(e,t),e.prototype.shouldDie=function(){return this.vitality<this.age},e.prototype.cripple=function(t){if(!(Math.random()<.5)){if(t&&this.diseased)return this.vitality*=2,void(this.diseased=!1);this.vitality/=2,this.diseased=!0}},e.prototype.move=function(){var t,e;this.age++,this.reproductionValue++;do{t=i.default.randomInt(-1,1),e=i.default.randomInt(-1,1)}while(!this.map.isInBounds(this.x+t,this.y+e)&&0===t&&0===e);var s=this.map.getObj(this.x+t,this.y+e);switch(s?s.colour:this.game.WATER_COLOUR){case this.game.GRASS_COLOUR:this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.reproduce(),this.x+=t,this.y+=e,this.map.setObj(this.x,this.y,this);break;case this.game.WATER_COLOUR:case this.colour:break;default:this.vitality>=this.map.getObj(this.x+t,this.y+e).vitality?(this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.reproduce(),this.x+=t,this.y+=e,this.map.killPerson(this.x,this.y,this)):(this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.kill())}this.shouldDie()&&(this.map.setObj(this.x,this.y,this.game.GRASS_TILE),this.kill())},e.prototype.reproduce=function(){if(!(this.reproductionValue<this.game.reproductiveThreshold)){this.reproductionValue=0;var t=i.default.randomInt(-5,5);this.map.setObj(this.x,this.y,new e(this.game,this.map,this.x,this.y,0,i.default.randomInt(0,100),this.colour,this.vitality+t))}},e.prototype.kill=function(){this.dead=!0,this.game.colonyRemove(this)},e}(t.default),h=o;exports.default=h;
},{"./tile":"zf4f","./util":"LsF4"}],"rEAj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=function(){return function(t,e,r){this.r=t,this.g=e,this.b=r}}(),e=t;exports.default=e;
},{}],"IoNL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./person")),a=e(require("./util")),i=e(require("./rgb_color"));function e(t){return t&&t.__esModule?t:{default:t}}var h=function(){function e(t,i,e){this.rgbCache={},this.coloniesNumber=e,this.game=t,this.canvas=i,this.height=i.height,this.width=i.width,this.context=i.getContext("2d"),this.imageData=this.context.getImageData(0,0,this.width,this.height),this.map=[];for(var h=0;h<this.width;h++)this.map[h]=[];for(h=0;h<this.imageData.data.length;h+=4){var s="#"+a.default.int2hex(this.imageData.data[h])+a.default.int2hex(this.imageData.data[h+1])+a.default.int2hex(this.imageData.data[h+2]);if(s===this.game.getColour(this.game.GRASS_COLOUR)){var o=h/4%this.width,r=Math.floor(h/4/this.width);this.map[o][r]=this.game.GRASS_TILE}if(s===this.game.getColour(this.game.WATER_COLOUR)){o=h/4%this.width,r=Math.floor(h/4/this.width);this.map[o][r]=this.game.WATER_TILE}}this.createColonies()}return e.prototype.isInBounds=function(t,a){return t>=0&&t<this.width&&a>=0&&a<this.height},e.prototype.getObj=function(t,a){return this.isInBounds(t,a)?this.map[t][a]:null},e.prototype.setObj=function(t,a,i){this.map[t][a]=i;var e=this.getRGBColour(i.colour),h=4*(a*this.width+t);this.imageData.data[h+0]=e.r,this.imageData.data[h+1]=e.g,this.imageData.data[h+2]=e.b,this.imageData.data[h+3]=255},e.prototype.getRGBColour=function(t){var a=this.game.getColour(t);if(!(a in this.rgbCache)){var e=/#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i.exec(a);this.rgbCache[a]=new i.default(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))}return this.rgbCache[a]},e.prototype.redraw=function(){this.context.putImageData(this.imageData,0,0)},e.prototype.killPerson=function(t,a,i){this.map[t][a].kill(),this.setObj(t,a,i)},e.prototype.createColonies=function(){for(var i,e,h,s,o,r=0;r<this.coloniesNumber;r++){for(;i=a.default.randomInt(0,this.width-1),e=a.default.randomInt(0,this.height-1),this.map[i][e].colour!==this.game.GRASS_COLOUR;);for(var n=0;n<50;n++)for(o=0;;){o+=1;do{o+=.01,h=i+a.default.randomInt(0,10),s=e+a.default.randomInt(0,10)}while(!this.isInBounds(h,s));if(o>=50)break;if(this.map[h][s].colour===this.game.GRASS_COLOUR){this.setObj(h,s,new t.default(this.game,this,h,s,0,a.default.randomInt(0,100),r,a.default.randomInt(0,100)));break}}}},e}(),s=h;exports.default=s;
},{"./person":"aaNL","./util":"LsF4","./rgb_color":"rEAj"}],"xKml":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("./board")),i=o(require("./tile")),e=o(require("./util"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function o(t,e,o,s,n,l,h,r,a){var c=this;void 0===h&&(h=!1),void 0===r&&(r=""),void 0===a&&(a=""),this.ageCount=0,this.colours=["#ffff00","#ff00ff","#ff0000","#8800ff","#ff8800","#888888","#8888ff","#ff0088","#000000","#0088ff","#00ff00","#0000ff"],this.coloniesColours=this.colours.length-2,this.colonies=[],this.GRASS_COLOUR=this.colours.length-2,this.WATER_COLOUR=this.colours.length-1,this.image=new Image,this.peopleCount=0,this.timer=0,this.htmlConnector=t,this.canvas=e,this.speed=n,this.coloniesNumber=s,this.GRASS_TILE=new i.default(this.GRASS_COLOUR),this.WATER_TILE=new i.default(this.WATER_COLOUR),this.reproductiveThreshold=l,this.image.onload=function(){c.setup()},this.image.onerror=function(){window.alert("loading failed")},this.image.src=o}return o.prototype.setup=function(){this.canvas.width=this.image.width,this.canvas.height=this.image.height,this.canvas.getContext("2d").drawImage(this.image,0,0);for(var i=0;i<this.coloniesNumber;i++)this.colonies[i]=[];this.map=new t.default(this,this.canvas,this.coloniesNumber),this.intervalPointer=setInterval(this.play.bind(this),this.speed),this.htmlConnector.$statisticsPanel.innerHTML="";for(i=0;i<this.coloniesNumber;i++)this.htmlConnector.$statisticsPanel.innerHTML+='<span style="color:'+this.colours[i]+'"></span><br>';this.coloniesLabels=this.htmlConnector.$statisticsPanel.querySelectorAll("span")},o.prototype.play=function(){this.lastTime=Date.now();for(var t=0;t<this.coloniesNumber;t++)if(null!==this.colonies[t]){for(var i=0,o=this.colonies[t];i<o.length;i++){var s=o[i];null!==s&&s.move()}0!==this.colonies[t].length?this.coloniesLabels[t].innerHTML="Colony "+(t+1)+": "+this.colonies[t].length+" Avg Vit : "+e.default.average(this.colonies[t]).toFixed(2)+" Max Vit: "+e.default.maxVitality(this.colonies[t]).toFixed(2):(this.coloniesLabels[t].innerHTML="<del>Colony "+(t+1)+": "+this.colonies[t].length+" Avg Vit : "+e.default.average(this.colonies[t]).toFixed(2)+" Max Vit: "+e.default.maxVitality(this.colonies[t]).toFixed(2)+"</del>",this.colonies[t]=null)}for(t=0;t<this.coloniesNumber;t++)null!==this.colonies[t]&&(this.colonies[t]=this.colonies[t].filter(function(t){return null!==t}),this.colonies[t].forEach(function(t,i){t.index=i}));this.map.redraw(),this.htmlConnector.$ageLabel.innerHTML="Age: "+this.ageCount++,this.timer+=Date.now()-this.lastTime,this.timer>250&&(this.htmlConnector.$fpsLabel.innerHTML="FPS: "+(1e3/(Date.now()-this.lastTime)).toFixed(0),this.timer=0)},o.prototype.getColour=function(t){return this.colours[t]},o.prototype.colonyPush=function(t){t.index=this.colonies[t.colour].length,this.colonies[t.colour].push(t),this.peopleCount++},o.prototype.colonyRemove=function(t){this.colonies[t.colour][t.index]=null,this.peopleCount--},o.prototype.stop=function(){clearInterval(this.intervalPointer)},o}(),n=s;exports.default=n;
},{"./board":"IoNL","./tile":"zf4f","./util":"LsF4"}],"Xxxt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./game")),t=o(require("./util"));function o(e){return e&&e.__esModule?e:{default:e}}var n=function(){function o(){var e=this;this.landWaterColours=!1,this.$canvas=document.getElementById("canvas"),this.$statisticsPanel=document.getElementById("test"),this.$ageLabel=document.querySelector("#age"),this.$fpsLabel=document.querySelector("#fps"),this.$mapSelect=document.querySelector("#level_map"),this.$mapSelect.addEventListener("change",function(){e.getPreview()}),this.$numberOfColonies=document.querySelector("#number_of_colonies"),this.$timeInterval=document.querySelector("#time_interval"),this.$reproductiveThreshold=document.querySelector("#reproductive_threshold"),this.$addMap=document.querySelector("#add_map"),this.$addMap.addEventListener("change",function(){e.updateMapList()}),this.$startGame=document.querySelector("#start_game"),this.$startGame.addEventListener("click",function(){e.startGame()}),this.$allowGWChanging=document.querySelector("#allow_gw_colours"),this.$allowGWChanging.addEventListener("click",function(){e.allowGWColourChanging()}),this.getPreview()}return o.prototype.startGame=function(){this.game&&this.game.stop(),this.game=new e.default(this,this.$canvas,this.$mapSelect.options[this.$mapSelect.selectedIndex].value,parseInt(this.$numberOfColonies.value,10),parseInt(this.$timeInterval.value,10),parseInt(this.$reproductiveThreshold.value,10))},o.prototype.getPreview=function(){var e=document.querySelector("canvas.preview"),t=new Image;t.onload=function(){e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0)},t.onerror=function(){window.alert("loading preview failed")},t.src=this.$mapSelect.options[this.$mapSelect.selectedIndex].value},o.prototype.updateMapList=function(){this.$mapSelect.innerHTML+='<option value="'+window.URL.createObjectURL(this.$addMap.files[0])+'" >'+this.$addMap.files[0].name+"</option>"},o.prototype.allowGWColourChanging=function(){var e=document.querySelector("canvas.preview");this.landWaterColours?(this.landWaterColours=!1,document.querySelector(".colorGWPick").style.display="none",e.removeEventListener("mousemove",this.pick)):(this.landWaterColours=!0,document.querySelector(".colorGWPick").style.display="block",e.addEventListener("mousemove",this.pick))},o.prototype.pick=function(e){var o=e.clientX,n=e.clientY,a=e.target.getContext("2d").getImageData(o,n,1,1).data,i="#"+t.default.int2hex(a[0])+t.default.int2hex(a[1])+t.default.int2hex(a[2]);document.querySelector(".colorGWPick").style.background=i,document.querySelector(".colorGWPick").textContent=i},o}(),a=n;exports.default=a;
},{"./game":"xKml","./util":"LsF4"}],"swTO":[function(require,module,exports) {
"use strict";var e=t(require("./html_connector"));function t(e){return e&&e.__esModule?e:{default:e}}window.onload=function(){(new e.default).startGame()};
},{"./html_connector":"Xxxt"}]},{},["swTO"], null)
//# sourceMappingURL=app.89565333.js.map